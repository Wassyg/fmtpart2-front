{"ast":null,"code":"import _defineProperty from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/src/Components/ProjectForm.js\";\n//Alimente le modal envoyé au tatoueur depuis le UserPage/FavTattoosProfile et depuis TattooModal/TattooArtistCardModal\nimport React from 'react';\nimport url from '../config.js'; //material UI\n\nimport { Step, Stepper, StepLabel, StepContent } from 'material-ui/Stepper';\nimport TextField from 'material-ui/TextField';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport FlatButton from 'material-ui/FlatButton';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider'; //reactstrap\n\nimport { Modal, ModalHeader, ModalBody } from 'reactstrap';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport SelectField from 'material-ui/SelectField';\nimport MenuItem from 'material-ui/MenuItem';\nimport { connect } from 'react-redux';\n\nvar ProjectForm =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(ProjectForm, _React$Component);\n\n  function ProjectForm(props) {\n    var _this;\n\n    _classCallCheck(this, ProjectForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ProjectForm).call(this, props));\n    _this.handleNext = _this.handleNext.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handlePrev = _this.handlePrev.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.handleChange = _this.handleChange.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.renderStepActions = _this.renderStepActions.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.toggle = _this.toggle.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      finished: false,\n      stepIndex: 0,\n      description: \"\",\n      phone: \"\",\n      availability: \"\",\n      value: \"Définissez un créneau\",\n      visible: false,\n      artistName: '',\n      artistEmail: ''\n    };\n    return _this;\n  }\n\n  _createClass(ProjectForm, [{\n    key: \"toggle\",\n    value: function toggle() {\n      this.setState({\n        visible: !this.state.visible\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var ctx = this; //collecter les informations de l'artiste depuis la DB\n\n      fetch('https://glacial-sierra-22438.herokuapp.com/artist?artist_id=' + this.props.artistId).then(function (response) {\n        return response.json();\n      }).then(function (data) {\n        ctx.setState({\n          artistName: data.result.artistNickname,\n          artistEmail: 'francois.fitzpatrick@gmail.com'\n        });\n      }).catch(function (error) {\n        console.log('Request failed', error);\n      });\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate(prevProps) {\n      if (this.props.clickToSend !== prevProps.clickToSend) {\n        this.setState({\n          visible: !this.state.visible\n        });\n      }\n    }\n  }, {\n    key: \"handleChange\",\n    value: function handleChange(event, index, value) {\n      var _this$setState;\n\n      this.setState((_this$setState = {}, _defineProperty(_this$setState, event.target.name, event.target.value), _defineProperty(_this$setState, \"value\", value), _this$setState));\n    }\n  }, {\n    key: \"handleNext\",\n    value: function handleNext() {\n      this.setState({\n        stepIndex: this.state.stepIndex + 1,\n        finished: this.state.stepIndex >= 2\n      }); //si on est sur la dernière page du form, envoyer les informations (user depuis le Store et tatoueur depuis la DB) au tatoueur à travers Zapier\n\n      if (this.state.stepIndex >= 2) {\n        var ctx = this; //fetch pour créer un nouveau lead et updater coté backend la DB User\n\n        fetch('https://glacial-sierra-22438.herokuapp.com/newlead', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          body: 'userID=' + ctx.props.userID + '&artistID=' + ctx.props.artistId + '&userAvailability=' + ctx.state.value + \"&userTattooDescription=\" + ctx.state.description + '&userTelephone=' + ctx.state.phone\n        }).then(function (response) {\n          return response.json();\n        }).then(function (data) {\n          console.log(data);\n        }).catch(function (error) {\n          console.log('Request failed', error);\n        }); //envoi sur Zapier\n\n        fetch('https://hooks.zapier.com/hooks/catch/4067341/cbsyve/', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/x-www-form-urlencoded'\n          },\n          body: 'artistName=' + ctx.state.artistName + '&artistEmail=' + ctx.state.artistEmail + '&userFirstName=' + ctx.props.userFirstName + '&userEmail=' + ctx.props.userEmail + '&userTelephone=' + ctx.state.phone + '&userTattooDescription=' + ctx.state.description + '&userAvailability=' + ctx.state.value + '&userFavoriteTattoo=' + ctx.props.userFavoriteTattoo\n        }).then(function (response) {\n          return response.json();\n        }).then(function (data) {\n          console.log(\"pour zapier\", data);\n        }).catch(function (error) {\n          console.log('Request failed', error);\n        });\n      }\n    }\n  }, {\n    key: \"handlePrev\",\n    value: function handlePrev() {\n      if (this.state.stepIndex > 0) {\n        this.setState({\n          stepIndex: this.state.stepIndex - 1\n        });\n      }\n    }\n  }, {\n    key: \"renderStepActions\",\n    value: function renderStepActions(step) {\n      var stepIndex = this.state.stepIndex;\n      return React.createElement(\"div\", {\n        style: {\n          margin: '12px 0'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, React.createElement(RaisedButton, {\n        label: stepIndex === 2 ? 'Envoyer' : 'Suivant',\n        disableTouchRipple: true,\n        disableFocusRipple: true,\n        primary: true,\n        onClick: this.handleNext,\n        style: {\n          marginRight: 12\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }), \" \", step > 0 && React.createElement(FlatButton, {\n        label: \"Pr\\xE9c\\xE9dent\",\n        disabled: stepIndex === 0,\n        disableTouchRipple: true,\n        disableFocusRipple: true,\n        onClick: this.handlePrev,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$state = this.state,\n          finished = _this$state.finished,\n          stepIndex = _this$state.stepIndex,\n          description = _this$state.description,\n          phone = _this$state.phone,\n          availability = _this$state.availability,\n          value = _this$state.value;\n      return React.createElement(MuiThemeProvider, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          maxHeight: 400,\n          margin: 'auto'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(Modal, {\n        isOpen: this.state.visible,\n        toggle: this.toggle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(ModalHeader, {\n        toggle: this.toggle,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"Partagez d\\xE8s maintenant votre projet avec \", this.state.artistName), React.createElement(ModalBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      }, React.createElement(Stepper, {\n        activeStep: stepIndex,\n        orientation: \"vertical\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, React.createElement(Step, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, React.createElement(StepLabel, {\n        className: \"stepLabelForm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173\n        },\n        __self: this\n      }, \"D\\xE9crivez votre projet\"), React.createElement(StepContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        name: \"description\",\n        hintText: \"ex : une fleur en dot sur l'omoplate\",\n        multiLine: true,\n        floatingLabelText: \"Parlez nous de votre projet\",\n        rows: 2,\n        rowsMax: 3,\n        fullWidth: true,\n        onChange: this.handleChange,\n        value: this.state.description,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      }), \" \", this.renderStepActions(0))), React.createElement(Step, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(StepLabel, {\n        className: \"stepLabelForm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, \"Pour \\xEAtre contact\\xE9\"), React.createElement(StepContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(TextField, {\n        name: \"phone\",\n        floatingLabelFixed: true,\n        floatingLabelText: \"Laissez votre num\\xE9ro au tatoueur\",\n        hintText: \"(+33)6 61 23 45 67\",\n        fullWidth: true,\n        onChange: this.handleChange,\n        value: this.state.phone,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }), \" \", this.renderStepActions(1))), React.createElement(Step, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184\n        },\n        __self: this\n      }, React.createElement(StepLabel, {\n        className: \"stepLabelForm\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, \"Vous pr\\xE9f\\xE9rez \\xEAtre contact\\xE9\"), React.createElement(StepContent, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186\n        },\n        __self: this\n      }, React.createElement(SelectField, {\n        name: \"availability\",\n        fullWidth: true,\n        onChange: this.handleChange,\n        value: this.state.value,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187\n        },\n        __self: this\n      }, React.createElement(MenuItem, {\n        value: \"D\\xE9finissez un cr\\xE9neau\",\n        primaryText: \"D\\xE9finissez un cr\\xE9neau\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        value: \"midi (entre 12h et 14h)\",\n        primaryText: \"midi (entre 12h et 14h)\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        value: \"apr\\xE8s-midi (entre 14h et 17h)\",\n        primaryText: \"apr\\xE8s-midi (entre 14h et 17h)\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191\n        },\n        __self: this\n      }), React.createElement(MenuItem, {\n        value: \"soir (entre 17h et 19h)\",\n        primaryText: \"soir (entre 17h et 19h)\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192\n        },\n        __self: this\n      })), this.renderStepActions(2)))), finished && React.createElement(\"p\", {\n        style: {\n          margin: '20px 0',\n          textAlign: 'center'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 199\n        },\n        __self: this\n      }, \"Votre demande a bien \\xE9t\\xE9 envoy\\xE9e \\xE0 \", this.state.artistName, \"!\")))));\n    }\n  }]);\n\n  return ProjectForm;\n}(React.Component);\n\nfunction mapStateToProps(store) {\n  // console.log(\"user depuis le reducer\", store.user);\n  return {\n    userID: store.user._id,\n    userFirstName: store.user.userFirstName,\n    userEmail: store.user.userEmail,\n    userTelephone: store.user.userTelephone,\n    userFavoriteTattoo: store.user.userFavoriteTattoo,\n    userTattooDescription: store.user.userTattooDescription,\n    userAvailability: store.user.userAvailability\n  };\n}\n\nexport default connect(mapStateToProps, null)(ProjectForm);","map":{"version":3,"sources":["/Users/wassimaguerro/Desktop/La Capsule/zz-FindMyTattooMVP/FindMyTattooFront/src/Components/ProjectForm.js"],"names":["React","url","Step","Stepper","StepLabel","StepContent","TextField","RaisedButton","FlatButton","MuiThemeProvider","Modal","ModalHeader","ModalBody","SelectField","MenuItem","connect","ProjectForm","props","handleNext","bind","handlePrev","handleChange","renderStepActions","toggle","state","finished","stepIndex","description","phone","availability","value","visible","artistName","artistEmail","setState","ctx","fetch","artistId","then","response","json","data","result","artistNickname","catch","error","console","log","prevProps","clickToSend","event","index","target","name","method","headers","body","userID","userFirstName","userEmail","userFavoriteTattoo","step","margin","marginRight","maxHeight","textAlign","Component","mapStateToProps","store","user","_id","userTelephone","userTattooDescription","userAvailability"],"mappings":"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","sourcesContent":["//Alimente le modal envoyé au tatoueur depuis le UserPage/FavTattoosProfile et depuis TattooModal/TattooArtistCardModal\n\nimport React from 'react';\nimport url from '../config.js';\n\n//material UI\nimport {Step, Stepper, StepLabel, StepContent} from 'material-ui/Stepper';\nimport TextField from 'material-ui/TextField';\nimport RaisedButton from 'material-ui/RaisedButton';\nimport FlatButton from 'material-ui/FlatButton';\nimport MuiThemeProvider from 'material-ui/styles/MuiThemeProvider'\n\n//reactstrap\nimport {Modal, ModalHeader, ModalBody} from 'reactstrap';\nimport 'bootstrap/dist/css/bootstrap.css';\n\nimport SelectField from 'material-ui/SelectField';\nimport MenuItem from 'material-ui/MenuItem';\n\nimport {connect} from 'react-redux';\n\nclass ProjectForm extends React.Component {\n  constructor(props) {\n    super(props);\n    this.handleNext = this.handleNext.bind(this);\n    this.handlePrev = this.handlePrev.bind(this);\n    this.handleChange = this.handleChange.bind(this);\n    this.renderStepActions = this.renderStepActions.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.state = {\n      finished: false,\n      stepIndex: 0,\n      description: \"\",\n      phone: \"\",\n      availability: \"\",\n      value: \"Définissez un créneau\",\n      visible: false,\n      artistName: '',\n      artistEmail: ''\n    }\n  }\n\n  toggle() {\n    this.setState({\n      visible: !this.state.visible\n    });\n  }\n  componentDidMount() {\n    var ctx = this;\n    //collecter les informations de l'artiste depuis la DB\n    fetch('https://glacial-sierra-22438.herokuapp.com/artist?artist_id=' + this.props.artistId)\n    .then(function(response) {\n      return response.json();\n    })\n    .then(function(data) {\n      ctx.setState({\n        artistName: data.result.artistNickname,\n        artistEmail: 'francois.fitzpatrick@gmail.com'\n      });\n    })\n    .catch(function(error) {\n      console.log('Request failed', error);\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.clickToSend !== prevProps.clickToSend) {\n      this.setState({\n        visible: !this.state.visible\n      })\n    }\n  }\n\n  handleChange(event, index, value) {\n    this.setState({\n      [event.target.name]: event.target.value,\n      value: value\n    });\n  }\n\n  handleNext() {\n    this.setState({\n      stepIndex: this.state.stepIndex + 1,\n      finished: this.state.stepIndex >= 2\n    })\n\n    //si on est sur la dernière page du form, envoyer les informations (user depuis le Store et tatoueur depuis la DB) au tatoueur à travers Zapier\n    if (this.state.stepIndex >= 2) {\n      var ctx = this;\n      //fetch pour créer un nouveau lead et updater coté backend la DB User\n      fetch('https://glacial-sierra-22438.herokuapp.com/newlead', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: 'userID=' + ctx.props.userID + '&artistID=' + ctx.props.artistId + '&userAvailability=' + ctx.state.value + \"&userTattooDescription=\" + ctx.state.description + '&userTelephone=' + ctx.state.phone\n      })\n      .then(function(response) {\n        return response.json();\n      })\n      .then(function(data) {\n        console.log(data)\n      })\n      .catch(function(error) {\n        console.log('Request failed', error);\n      });\n\n      //envoi sur Zapier\n      fetch('https://hooks.zapier.com/hooks/catch/4067341/cbsyve/', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/x-www-form-urlencoded'\n        },\n        body: 'artistName=' + ctx.state.artistName + '&artistEmail=' + ctx.state.artistEmail + '&userFirstName=' + ctx.props.userFirstName + '&userEmail=' + ctx.props.userEmail + '&userTelephone=' + ctx.state.phone + '&userTattooDescription=' + ctx.state.description + '&userAvailability=' + ctx.state.value + '&userFavoriteTattoo=' + ctx.props.userFavoriteTattoo\n      })\n      .then(function(response) {\n        return response.json();\n      })\n      .then(function(data) {\n        console.log(\"pour zapier\",data)\n      })\n      .catch(function(error) {\n        console.log('Request failed', error);\n      });\n    }\n  };\n\n  handlePrev() {\n    if (this.state.stepIndex > 0) {\n      this.setState({\n        stepIndex: this.state.stepIndex - 1\n      });\n    }\n  };\n\n  renderStepActions(step) {\n    const {stepIndex} = this.state;\n\n    return (<div style={{\n        margin: '12px 0'\n      }}>\n      <RaisedButton label={stepIndex === 2\n          ? 'Envoyer'\n          : 'Suivant'} disableTouchRipple={true} disableFocusRipple={true} primary={true} onClick={this.handleNext} style={{\n          marginRight: 12\n        }}/> {step > 0 && (<FlatButton label=\"Précédent\" disabled={stepIndex === 0} disableTouchRipple={true} disableFocusRipple={true} onClick={this.handlePrev}/>)}\n    </div>);\n  }\n\n  render() {\n    const {\n      finished,\n      stepIndex,\n      description,\n      phone,\n      availability,\n      value\n    } = this.state;\n\n    return (\n      <MuiThemeProvider>\n      {/* <Button color=\"danger\" onClick={this.toggle}>Formulaire</Button> */}\n      <div style={{\n          maxHeight: 400,\n          margin: 'auto'\n        }}>\n        <Modal isOpen={this.state.visible} toggle={this.toggle}>\n          <ModalHeader toggle={this.toggle}>Partagez dès maintenant votre projet avec {this.state.artistName}</ModalHeader>\n          <ModalBody>\n\n            <Stepper activeStep={stepIndex} orientation=\"vertical\">\n              <Step>\n                <StepLabel className=\"stepLabelForm\">Décrivez votre projet</StepLabel>\n                <StepContent>\n                  <TextField name=\"description\" hintText=\"ex : une fleur en dot sur l'omoplate\" multiLine={true} floatingLabelText=\"Parlez nous de votre projet\" rows={2} rowsMax={3} fullWidth={true} onChange={this.handleChange} value={this.state.description}/> {this.renderStepActions(0)}\n                </StepContent>\n              </Step>\n              <Step>\n                <StepLabel className=\"stepLabelForm\">Pour être contacté</StepLabel>\n                <StepContent>\n                  <TextField name=\"phone\" floatingLabelFixed={true} floatingLabelText=\"Laissez votre numéro au tatoueur\" hintText=\"(+33)6 61 23 45 67\" fullWidth={true} onChange={this.handleChange} value={this.state.phone}/> {this.renderStepActions(1)}\n                </StepContent>\n              </Step>\n              <Step>\n                <StepLabel className=\"stepLabelForm\">Vous préférez être contacté</StepLabel>\n                <StepContent>\n                  <SelectField name=\"availability\" fullWidth={true} onChange={this.handleChange} value={this.state.value}>\n\n                    <MenuItem value=\"Définissez un créneau\" primaryText=\"Définissez un créneau\"/>\n                    <MenuItem value=\"midi (entre 12h et 14h)\" primaryText=\"midi (entre 12h et 14h)\"/>\n                    <MenuItem value=\"après-midi (entre 14h et 17h)\" primaryText=\"après-midi (entre 14h et 17h)\"/>\n                    <MenuItem value=\"soir (entre 17h et 19h)\" primaryText=\"soir (entre 17h et 19h)\"/>\n                  </SelectField>\n                  {this.renderStepActions(2)}\n                </StepContent>\n              </Step>\n            </Stepper>\n            {\n              finished && (<p style={{\n                  margin: '20px 0',\n                  textAlign: 'center'\n                }}>Votre demande a bien été envoyée à {this.state.artistName}\n                !</p>)\n            }\n          </ModalBody>\n        </Modal>\n      </div>\n    </MuiThemeProvider>);\n  }\n}\n\nfunction mapStateToProps(store) {\n  // console.log(\"user depuis le reducer\", store.user);\n  return {\n    userID: store.user._id,\n    userFirstName: store.user.userFirstName,\n    userEmail: store.user.userEmail,\n    userTelephone: store.user.userTelephone,\n    userFavoriteTattoo: store.user.userFavoriteTattoo,\n    userTattooDescription: store.user.userTattooDescription,\n    userAvailability: store.user.userAvailability\n  }\n\n}\n\nexport default connect(mapStateToProps, null)(ProjectForm);\n"]},"metadata":{},"sourceType":"module"}